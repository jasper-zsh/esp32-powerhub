# BLE通讯设计

设备提供2个Characteristic，一个工作在Read模式用来供控制端读取当前开关状态，另一个工作在Write模式用于接收来自控制端的指令。

## 数据结构
字节序为BE

### 开关状态
每路通道使用1字节无符号整数表示，0表示关闭（GPIO高阻），255表示开启（GPIO高电平），其他值表示占空比（value / 255）

### 控制指令
控制指令由至少2字节的不定长数据表示，第一字节为模式，第二字节为通道号（0-3）；第三字节起为模式参数；指令表如下：

|模式|说明|参数说明|
|---|---|---|
|0x00|设置值|1字节无符号整数，表示要为通道设置的值|
|0x01|渐变|第一个参数为1字节无符号整数，表示要为通道设置的值；第二个参数为2字节无符号整数，表示渐变时长，单位毫秒|
|0x02|等速闪烁|2字节无符号整数，表示闪烁周期|
|0x03|爆闪|第一个参数为1字节无符号整数，表示点亮次数；第二个参数为2字节无符号整数，表示总闪烁时长，单位毫秒，闪烁周期为总时长/点亮次数（50%占空，ON=周期/2，OFF=周期/2）；第三个参数为2字节无符号整数，表示停顿时长，单位毫秒，为0时表示完成一组闪烁就关闭|
